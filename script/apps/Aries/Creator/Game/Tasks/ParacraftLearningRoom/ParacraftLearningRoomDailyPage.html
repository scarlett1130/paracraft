<!-- "script/apps/Aries/Creator/Game/Tasks/ParacraftLearningRoom/ParacraftLearningRoomDailyPage.html" -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>
</head>
<body>
<pe:mcml>
<script refresh="true" type="text/npl" src="ParacraftLearningRoomDailyPage.lua"><![CDATA[
local KeepWorkItemManager = NPL.load("(gl)script/apps/Aries/Creator/HttpAPI/KeepWorkItemManager.lua");
local ParacraftLearningRoomDailyPage = NPL.load("(gl)script/apps/Aries/Creator/Game/Tasks/ParacraftLearningRoom/ParacraftLearningRoomDailyPage.lua");
ParacraftLearningRoomDailyPage.OnInit()
function ClosePage()
    Page:CloseWindow();
end
function DS_Items(index)
    if(index == nil) then
        return #ParacraftLearningRoomDailyPage.Current_Item_DS;
    else
        return ParacraftLearningRoomDailyPage.Current_Item_DS[index];
    end
end
function IsVip()
    return ParacraftLearningRoomDailyPage.IsVip();
end
function GetNextDay()
    return ParacraftLearningRoomDailyPage.GetNextDay();
end
function IsNextDay(index)
    return ParacraftLearningRoomDailyPage.IsNextDay(index);
end

function IsFuture(index)
    return ParacraftLearningRoomDailyPage.IsFuture(index);
end

function HasCheckedToday()
    return ParacraftLearningRoomDailyPage.HasCheckedToday();
end
function SaveToLocal()
    ParacraftLearningRoomDailyPage.SaveToLocal();
end
function OnCheck()
    ParacraftLearningRoomDailyPage.OnCheck();
end
function OnOpenWeb(index)
    ParacraftLearningRoomDailyPage.OnOpenWeb(index);
end

function OnOpenWebExchange()
    ParaGlobal.ShellExecute("open", "explorer.exe", "https://keepwork.com/", "", 1); 
end

function GetLabel(index)
    local label;
    if(ParacraftLearningRoomDailyPage.IsNextDay(index) and not ParacraftLearningRoomDailyPage.HasCheckedToday())then
        label = string.format(L"第%d天",index);
    else
        label = string.format(L"%d",index);
    end
    return label
end
function GetExchangePoints()
    local gsid = 10002;
    local bHas,guid,bagid,copies = KeepWorkItemManager.HasGSItem(gsid)
    copies = copies or 0;
    local s = string.format("目前积分:%d",copies);
    return s;
end
]]></script>
    <aries:window mode="thin" title='<%= L"每日签到：《高手成长日记》"%>' onclose="ClosePage">
    <div style="width:800px;height:500px;">
        <div style="height:40px;">
            <div style="float:left;margin-left:10px;margin-top:20px;color:#ffffff;">每日签到并观看1分钟的高手教学视频，送积分。</div>
            <div style="float:left;margin-top:20px;color:#ffffff;"><%=GetExchangePoints()%></div>
            <div style="float:left;margin-left:10px;"><input type="button"  value='<%=L"积分兑换"%>' style="margin-top:15px;height:30px;" class="mc_yellow_button_with_fillet" onclick="OnOpenWebExchange" /></div>
        </div>
        <div style="margin-top:10px;">
            <pe:gridview style="margin:0px;width:800px;height:400px;" name="item_gridview" CellPadding="5" VerticalScrollBarStep="36" VerticalScrollBarOffsetX="8" AllowPaging="false" ItemsPerLine="11" DefaultNodeHeight = "32" 
                DataSource='<%=DS_Items%>'>
	            <Columns>
                            <div style="width:64px;height:100px;">

                                <pe:if condition='<%= IsFuture(Eval("index")) %>'>
                                    <input type="button" name='<%= Eval("index")%>' value='<%= GetLabel(Eval("index"))%>' style="width:64px;height:64px;color:#ffffff;" class="mc_light_grey_button_with_fillet"  onclick="OnOpenWeb"  />
                                </pe:if>
                                <pe:if condition='<%= not IsFuture(Eval("index")) %>'>
                                    <pe:if condition='<%= IsNextDay(Eval("index")) %>'>
                                        <pe:if condition='<%= HasCheckedToday(Eval("index")) %>'>
                                            <input type="button" name='<%= Eval("index")%>' value='<%= GetLabel(Eval("index"))%>' style="width:64px;height:64px;color:#ffffff;" class="mc_light_grey_button_with_fillet"   onclick="OnOpenWeb"  />
                                        </pe:if>
                                        <pe:if condition='<%= not HasCheckedToday(Eval("index")) %>'>
                                            <input type="button" name='<%= Eval("index")%>' value='<%= GetLabel(Eval("index"))%>' style="width:64px;height:64px;color:#ffffff;" class="mc_blue_button_with_fillet"  onclick="OnOpenWeb"  />
                                                <div style="margin-left:7px;margin-top:5px;">
                                                <input type="button" style="width:50px;height:30px;" class="mc_yellow_button_with_fillet"  value='<%= L"签到"%>' name='<%= Eval("index")%>' onclick="OnOpenWeb"/>
                                            </div>
                                        </pe:if>
                                    </pe:if>
                                    <pe:if condition='<%= not IsNextDay(Eval("index")) %>'>
                                        <input type="button" name='<%= Eval("index")%>' value='<%= GetLabel(Eval("index"))%>' style="width:64px;height:64px;color:#ffffff;" class="mc_green_button_with_fillet"  onclick="OnOpenWeb"  />
                                    </pe:if>
                                </pe:if>
                                
                            </div>
                            
                </Columns>
	            <EmptyDataTemplate>
	            </EmptyDataTemplate>
            </pe:gridview>
        </div>
    </div>
    
</aries:window>
</pe:mcml>
</body>
</html>

